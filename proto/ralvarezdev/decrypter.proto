syntax = "proto3";

package ralvarezdev;

import "google/protobuf/empty.proto";

service Decrypter {
  rpc SendEncryptedFile(stream SendEncryptFileRequest) returns (google.protobuf.Empty);
  rpc ListCompanyFiles(google.protobuf.Empty) returns (ListCompanyFilesResponse);
  rpc DecryptFile(DecryptFileRequest) returns (stream DecryptFileResponse);
}

message SendEncryptFileRequest {
    string filename = 1;
    bytes content = 2;
    bytes content_hash = 3;
    bytes encrypted_aes_256_key = 4;
}

message CompanyFiles {
    string company_name = 1;
    repeated string filenames = 2;
}

message ListCompanyFilesResponse {
    repeated CompanyFiles company_files = 1;
}

message DecryptFileRequest {
    string filename = 1;
}

message DecryptFileResponse {
    bytes file_content = 1;
    string common_name = 2;
    string organization = 3;
    string organizational_unit = 4;
    string country = 5;
    string state = 6;
    string locality = 7;
}